\chapter {Rice-Shapiro's theorem}
A property of the functions computed by programs can be semi-decidable \textbf{only if} it depends on a finite part of the function (behavior on finite inputs).

Finite function $ \theta: \nat\rightarrow\nat $ s.t. $ dom(\theta) $ finite. This means that the set of input-output pairs is finite; in other words $ \theta = \{(x_1,y_1),\dots(x_n,y_n) \} $ and does not end otherwise.

Given $ f:\nat\rightarrow\nat $ then $ \theta  $ is a subfunction of \textit{f} if $ \theta \subseteq f $

\textbf{Notazione:}
\begin{itemize}
\item $ W_e $ domain of the function $ \phi_e $ that is the function computed by the program of index $e$;
\item $ E_e = \{\phi_e(x)|x\in W_e \}$;
\item $ H(x,y,t) = P_x(y)\downarrow $ in \textit{t} steps or less;
\item $ S(x,y,z,t) = P_x(y)\downarrow z $
\item $ K = \{x|x\in W_x \} = \{x|\phi_x(x)\downarrow \} = \{x|P_x(x)\downarrow \}$
\end{itemize}

Proof of Rice-Shapiro's theorem ($ \forall f \in \mathcal{C} f \in \mathcal{A} \Leftrightarrow \exists\theta\subseteq f \mid \theta $ finite and $ \theta\in A) $

1) $ \exists f \in \mathcal{C}. f \not\in \mathcal{A} \land \exists\theta\subseteq f, \theta\in\mathcal{A} \Rightarrow \mathcal{A}$ not r.e

2) $ \exists f \in \mathcal{C}. f\in\mathcal{A} \land \forall\theta\subseteq f, \theta\not\in\mathcal{A}\Rightarrow \mathcal{A} $ not r.e.

\textbf{Proof of 1)}

$ f\not\in \mathcal{A} \land \theta\subseteq \mathcal{A}$ dim. that $ \bar{K}\leq A $ ($ \mathcal{A} $ set of functions, $A$ set of programs)

We define the function:
\begin{equation*}
  g(x,y) = \begin{cases}
    \theta(y) & x \in \bar{K} \\
    f(y)      & x \in K
  \end{cases}
\end{equation*}

\begin{equation*}
  = \begin{cases}
    \uparrow         & x \in \bar{K} \land x \not\in dom(\theta) \\
    \theta(y) = f(y) & x \not\in \bar{K} \land x \in dom(\theta) \\
    f(y)             & x\in K
  \end{cases}
\end{equation*}

\begin{equation*}
  = \begin{cases}
    f(y)     & x\in K\lor(x\not\in\bar{K}\land y\in dom(\theta)) \\
    \uparrow & $ altrimenti $
  \end{cases}
\end{equation*}

But $ x\in K\lor y\in dom(\theta) = Q(x,y)$ predicate. $ x\in K $ semi-decidable; $ y \in dom(\theta) $ decidable; therefore $ Q(x,y) $ semi-decidable.

\begin{equation*}
  SC_Q(x,y) = \begin{cases}
    1 & Q(x,y)         \\
    0 & $ altrimenti $
  \end{cases}
\end{equation*}

This is computable $ = f(y) \times SC_Q(x,y) $ computable.

For SMN, given that \textit{g} is computable, $ \exists S:\nat\rightarrow\nat $ s.t.
\begin{equation*}
  g(x,y) = \begin{cases}
    \theta(y) & x \in \bar{K} \\
    f(y)      & x \in K
  \end{cases}
\end{equation*}

$ g(x,y) = \phi_{S(x)}(y)$

$S$ is the reduction function for $ \bar{K}\leq A $

\begin{itemize}
\item $ x\in\bar{K} \Rightarrow \forall y. \phi_{S(x)}(y) = g(x,y) = \theta(y) \Rightarrow \phi_{S(x)} = \theta \Rightarrow S(x) \in A $
\item $ x\not\in\bar{K}\Rightarrow x\in K\Rightarrow\forall y\phi_{S(x)}(y) = g(x,y)=f(y)\Rightarrow\phi_{S(x)}=f\Rightarrow S(x)\in\bar{A}$
\end{itemize}

Hence $A$ is reduced to $ \bar{K} $ which is not r.e. therefore A is not r.e.

\textbf{Proof of 2)}

let $ f\in\mathcal{A}\land\theta\subseteq f $ be with $ \theta $ finished, $ \theta\not\in\mathcal{A} $

We want it to be in quotes because it's not formal: \begin{equation*}
  g(x,y) = \begin{cases}
    f(y)      & x \in\bar{K} $ cioÃ¨ $ \phi_x(x)\uparrow                              \\
    \theta(y) & $ per qualche $ \theta\subseteq f $ finita altrimenti ($ x\in K $) $
  \end{cases}
\end{equation*}

This is computable, meaning $f(y) \times SC_Q(x,y) $ is computable.

for SMN there exists $ S:\nat\rightarrow\nat $ total computable s.t. $ \forall x,y. \phi_{S(x)}(y) = g(x,y) $

We have to prove that S is a reduction function for $ \bar{K}\leq A $

\begin{itemize}
\item $ x\in\bar{K}\\
  \Rightarrow\phi_{S(x)}\uparrow \\
  \Rightarrow\forall y\lnot H(x,x,y)\\
  \Rightarrow \forall y.\phi_{S(x)}(y) = g(x,y) = f(y)\\
  \Rightarrow f = \phi_{S(x)}\\ \Rightarrow S(x)\in A$
\item $ x\not\in\bar{K}\\ \Rightarrow x\in K\\
  \Rightarrow \phi_x(x)\downarrow\\
  \Rightarrow \exists t_0 $ s.t. $ \forall t>t_0. H(x,x,t), \forall t<t_0. \lnot H(x,x,y)\\
  \Rightarrow\phi_{S(x)}(y) = g(x,y)\\
  \Rightarrow \phi_{S(x)}\subseteq f$ finite $\\
  \Rightarrow S(x) \in \bar{A} $
\end{itemize}

Rice-Shapiro's theorem proved.