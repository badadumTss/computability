\chapter {Rice-Shapiro theorem}
Rice-Shapiro states that A property of the functions computed by
programs can be semi-decidable \textbf{only if} it depends on a finite
part of the function (behavior on finite inputs). That is to say:

\begin{theorem}[Rice-Shapiro theorem]

  Let $\mathcal{A} \subseteq \mathcal{C}$ a set of computable
  functions. If the set $\{x \mid \varphi_x \in \mathcal{A}\}$ is
  r.e., then
  \[
    \forall f (f \in \mathcal{A} \Leftrightarrow \exists \theta \mbox{
      finite function, } \theta \subseteq f \land \theta \subseteq
    \mathcal{A})
  \]
\end{theorem}

In order to prove it we'll need some tools:

\begin{definition}[Finite function]
  A finite function is a function $ \theta: \nat\rightarrow\nat $
  s.t. $ dom(\theta) $ finite.  This means that the set of
  input-output pairs is finite; in other words
  $ \theta = \{(x_1,y_1),\dots(x_n,y_n) \} $ and does not end
  otherwise.
\end{definition}

Given $ f:\nat\rightarrow\nat $, $ \theta $ is a subfunction of
\textit{f} if $ \theta \subseteq f $

\begin{notation}\mbox{}\\*
  \begin{itemize}
  \item $ W_e $ domain of the function $ \varphi_e $ that is the function
    computed by the program of index $e$;
  \item $ E_e = \{\varphi_e(x)|x\in W_e \}$;
  \item $ H(x,y,t) = P_x(y)\downarrow $ in \textit{t} steps or less;
  \item $ S(x,y,z,t) = P_x(y)\downarrow z $
  \item $ K = \{x|x\in W_x \} = \{x|\varphi_x(x)\downarrow \} =
    \{x|P_x(x)\downarrow \}$
  \end{itemize}
\end{notation}

\section{Proof of Rice-Shapiro theorem}

\begin{proof}
  
  $ \forall f \in \mathcal{C} (f \in \mathcal{A} \Leftrightarrow
  \exists\theta\subseteq f \mid \theta $ finite and $ \theta\in A)$
  
  1)
  $ \exists f \in \mathcal{C} \; . \; f \not\in \mathcal{A} \land
  \exists\theta\subseteq f, \theta\in\mathcal{A} \Rightarrow
  \mathcal{A}$ not r.e

  2)
  $ \exists f \in \mathcal{C}. f\in\mathcal{A} \land
  \forall\theta\subseteq f, \theta\not\in\mathcal{A}\Rightarrow
  \mathcal{A} $ not r.e.

  \begin{proof}[proof of 1)]

    $ f\not\in \mathcal{A} \land \theta\subseteq \mathcal{A}$

    that $
    \bar{K}\leq A $ ($ \mathcal{A} $ set of functions, $A$ set of
    programs)

    We define the function:
    \begin{equation*}
      \begin{aligned}
        g(x,y) & = \begin{cases}
          \theta(y) & x \in \bar{K} \\
          f(y) & x \in K
        \end{cases} \\
               & = \begin{cases}
                 \uparrow & x \in \bar{K} \land x \not\in dom(\theta) \\
                 \theta(y) = f(y) & x \not\in \bar{K} \land x \in dom(\theta) \\
                 f(y) & x\in K
               \end{cases}\\
               &= \begin{cases}
                 f(y) & x \in K\lor(x\not\in\bar{K}\land y\in dom(\theta)) \\
                 \uparrow & $ altrimenti $
               \end{cases}
      \end{aligned}
    \end{equation*}

    But $ x\in K\lor y\in dom(\theta) = Q(x,y)$ predicate. $ x\in K $
    semi-decidable; $ y \in dom(\theta) $ decidable; therefore $ Q(x,y) $
    semi-decidable.

    \begin{equation*}
      SC_Q(x,y) = \begin{cases}
        1 & Q(x,y) \\
        0 & $ altrimenti $
      \end{cases}
    \end{equation*}

    This is computable $ = f(y) \times SC_Q(x,y) $ computable.

    For SMN, given that \textit{g} is computable, $ \exists
    S:\nat\rightarrow\nat $ s.t.
    \begin{equation*}
      g(x,y) = \begin{cases}
        \theta(y) & x \in \bar{K} \\
        f(y) & x \in K
      \end{cases}
    \end{equation*}

    $ g(x,y) = \varphi_{S(x)}(y)$

    $S$ is the reduction function for $ \bar{K}\leq A $

    \begin{itemize}
    \item $ x\in\bar{K} \Rightarrow \forall y. \varphi_{S(x)}(y) = g(x,y) =
      \theta(y) \Rightarrow \varphi_{S(x)} = \theta \Rightarrow S(x) \in A $
    \item $ x\not\in\bar{K}\Rightarrow x\in K\Rightarrow\forall
      y\varphi_{S(x)}(y) = g(x,y)=f(y)\Rightarrow\varphi_{S(x)}=f\Rightarrow
      S(x)\in\bar{A}$
    \end{itemize}

    Hence $A$ is reduced to $ \bar{K} $ which is not r.e. therefore A is
    not r.e.

  \end{proof}

  \begin{proof}[proof of 2)]
    let $ f\in\mathcal{A}\land\theta\subseteq f $ be with $ \theta $
    finished, $ \theta\not\in\mathcal{A} $

    We want it to be in quotes because it's not formal: \begin{equation*}
      g(x,y) = \begin{cases}
        f(y) & x \in\bar{K} $ cioÃ¨ $ \varphi_x(x)\uparrow \\
        \theta(y) & $ for some $ \theta\subseteq f $ finite, otherwise ($ x\in K $) $
      \end{cases}
    \end{equation*}

    This is computable, meaning $f(y) \times SC_Q(x,y) $ is
    computable.

    for SMN there exists $ S:\nat\rightarrow\nat $ total computable s.t. $
    \forall x,y. \varphi_{S(x)}(y) = g(x,y) $

    We have to prove that S is a reduction function for $ \bar{K}\leq A $

    \begin{itemize}
    \item $ x\in\bar{K}\\ \Rightarrow\varphi_{S(x)}\uparrow \\
      \Rightarrow\forall y\lnot H(x,x,y)\\ \Rightarrow \forall
      y.\varphi_{S(x)}(y) = g(x,y) = f(y)\\ \Rightarrow f = \varphi_{S(x)}\\
      \Rightarrow S(x)\in A$
    \item
      $ x\not\in\bar{K}\\ \Rightarrow x\in K\\ \Rightarrow
      \varphi_x(x)\downarrow\\ \Rightarrow \exists t_0 $ s.t.
      $ \forall
      t>t_0. H(x,x,t), \forall t<t_0. \lnot H(x,x,y)\\
      \Rightarrow\varphi_{S(x)}(y) = g(x,y)\\ \Rightarrow
      \varphi_{S(x)}\subseteq f$ finite
      $\\ \Rightarrow S(x) \in \bar{A} $
    \end{itemize}
  \end{proof}

  Rice-Shapiro's theorem proved.
\end{proof}

\section{Rice-Shapiro Exercises}

\begin{example}\label{exe:rice1}
  $A = \{ x \mid \varphi_x $ total $\}$ is not r.e.

  \begin{proof}
    Clearly $A$ is saturated, and the set of functions from wich it
    comes is $\mathcal{A} = \{f \in \mathcal{C} \mid f $ total
    $\}$. That is to say $A = \{x \mid \varphi_x \in
    \mathcal{A}\}$. Given any function $f \in \mathcal{A}$ (total by
    definition) clearly we know that $\forall \theta \subseteq f$
    finite $\theta \notin \mathcal{A}$, since each and every finite
    function is partial $\rightarrow$ for Rice-Shapiro theorem $A$ is
    not r.e.
  \end{proof}
\end{example}

\begin{example}\label{exe:rice2}
  $\bar{A} = \{x \mid \varphi_x $ non total $\}$ is not r.e.

  \begin{proof}
    Let $\bar{\mathcal{A}} = \{f \in \mathcal{C} \mid f $ non total
    $\}$. We observe that each $\theta$ finite is in
    $\bar{\mathcal{A}}$, but no total extension of such $\theta$ can
    be included in $\bar{\mathcal{A}}$. Again, for Rice-Shapiro
    $\bar{A}$ is not r.e.
  \end{proof}
\end{example}

The exercises \ref{exe:rice1} and \ref{exe:rice2} are essential to
understand two core situations in wich we can apply the theorem:

\begin{observation}
  Let $\mathcal{A} \subseteq \mathcal{C}$ be a set of computable
  functions s.t. $A = \{ x \mid \varphi_x \in \mathcal{A}\}$ is
  r.e. Then
  \begin{enumerate}[label=(i)]
  \item if \(\forall \theta \) finite
    \( \theta \notin \mathcal{A} \Rightarrow \mathcal{A} = \emptyset\)
  \item
    \(\emptyset \in \mathcal{A} \Rightarrow \mathcal{A} =
    \mathcal{C}\)
  \end{enumerate}

  \begin{proof}
    \begin{enumerate}[label=(i)]
    \item given $f \in \mathcal{C}$ we know that $f \in \mathcal{A}$
      iff $\exists \theta \subseteq f$ finite
      $\theta \in \mathcal{A} \rightarrow f \notin \mathcal{A}$
    \item given $f \in \mathcal{C}$, since $\emptyset \subseteq f$ and
      $\emptyset \in \mathcal{A} \Rightarrow f \in \mathcal{A}$
    \end{enumerate}
  \end{proof}
\end{observation}

\begin{exercise}
  Study the recursiveness of $A = \{x \mid \varphi_x = \mathds{1}\}$

  \begin{enumerate}
  \item[(*)] $A$ is not r.e.

    Infact the set of functions is in this case
    $\mathcal{A} = \{\mathds{1}\}$, wich
    \begin{itemize}
    \item does not contain finite functions
    \item is not empty
    \end{itemize}
    And therefore is not r.e.

  \item[(**)] $\bar{A}$ is not r.e.

    Infact $\bar{\mathcal{A}} = \mathcal{C} - \{\mathds{1}\}$, and we
    have that
    \begin{itemize}
    \item $\emptyset \in \bar{\mathcal{A}}$
    \item $\bar{\mathcal{A}} \neq \mathcal{C}$
    \end{itemize}
    And therefore $\bar{A}$ is not r.e.
  \end{enumerate}
\end{exercise}